<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UrURL ‚îÇ Profile</title>
    <link rel="stylesheet" href="main.css">
    <script src="ururl-core.js"></script>
    <style>
        body { background: #f8f9fa; display: flex; justify-content: center; padding: 20px; }
        .v-container { width: 100%; max-width: 400px; display: flex; flex-direction: column; align-items: center; }
        .hidden { display: none !important; }
        
        /* PIN Screen Style */
        #pin-screen { text-align: center; margin-top: 50px; background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        .pin-input { font-size: 2rem; width: 140px; text-align: center; letter-spacing: 8px; border: 2px solid #007AFF; border-radius: 10px; margin: 20px 0; padding: 10px; }

        /* Profile Style */
        .profile-card { width: 100%; text-align: center; background: white; border-radius: 25px; padding: 40px 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
        .v-img { width: 110px; height: 110px; border-radius: 50%; background-size: cover; background-position: center; margin: 0 auto 15px; background-color: #eee; border: 4px solid white; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        h2 { color: #0A1A3C; margin-bottom: 10px; }
        .v-bio { color: #666; font-size: 14px; margin-bottom: 25px; line-height: 1.5; }
        
        /* Button Style */
        .v-btn { display: block; width: 100%; padding: 15px; margin-bottom: 10px; border-radius: 12px; text-decoration: none; font-weight: bold; font-size: 14px; transition: 0.2s; }
        .v-btn-primary { background: #0A1A3C; color: white; }
        .v-btn-outline { background: #fff; color: #0A1A3C; border: 1px solid #eee; }
        .v-btn:active { transform: scale(0.98); }
    </style>
</head>
<body>

    <div class="v-container">
        <div id="pin-screen" class="hidden">
            <h2 style="font-size: 1.2rem;">Locked Profile</h2>
            <p style="font-size: 13px; color: #777;">Enter the 4-digit PIN to view</p>
            <input type="password" id="unlock-pin" class="pin-input" maxlength="4" inputmode="numeric">
            <button id="btn-unlock" class="main-btn" style="width: 100%;">UNLOCK</button>
        </div>

        <div id="profile-content" class="profile-card hidden">
            <div id="v-img" class="v-img"></div>
            <h2 id="v-n"></h2>
            <p id="v-b" class="v-bio"></p>

            <div id="v-actions">
                <a id="v-l" href="" target="_blank" class="v-btn v-btn-primary hidden">üåê VISIT WEBSITE</a>
                <a id="v-e" href="" class="v-btn v-btn-outline hidden">üìß SEND EMAIL</a>
                <a id="v-c" href="" class="v-btn v-btn-outline hidden">üìû CONTACT</a>
            </div>
        </div>
    </div>

    <script>
        // Start the logic
        const params = new URLSearchParams(window.location.search);
        const suitcase = params.get('d');

        if (!suitcase) {
            document.body.innerHTML = "<h2>Profile link is broken.</h2>";
        } else {
            const data = UrURL.unpack(suitcase);
            if (data) {
                // Check if a PIN (Count 7) was set
                if (data.k && data.k.trim().length === 4) {
                    document.getElementById('pin-screen').classList.remove('hidden');
                    document.getElementById('btn-unlock').onclick = () => {
                        if (document.getElementById('unlock-pin').value === data.k) {
                            render(data);
                        } else {
                            alert("Incorrect PIN");
                            document.getElementById('unlock-pin').value = "";
                        }
                    };
                } else {
                    render(data);
                }
            } else {
                document.body.innerHTML = "<h2>Invalid profile data.</h2>";
            }
        }

        function render(d) {
            document.getElementById('pin-screen').classList.add('hidden');
            document.getElementById('profile-content').classList.remove('hidden');

            document.getElementById('v-n').innerText = d.n;
            document.getElementById('v-b').innerText = d.b;
            
            if (d.p) document.getElementById('v-img').style.backgroundImage = `url(${d.p})`;

            const setupBtn = (id, val, prefix = "") => {
                const el = document.getElementById(id);
                if (val && val.trim() !== "") {
                    el.href = prefix + val;
                    el.classList.remove('hidden');
                }
            };

            setupBtn('v-l', d.l);          // Link
            setupBtn('v-e', d.e, "mailto:"); // Email
            setupBtn('v-c', d.c, "tel:");    // Contact
        }
    </script>
</body>
</html>
